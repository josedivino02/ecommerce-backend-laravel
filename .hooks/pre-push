#!/bin/sh

# Exibir mensagem de inÃ­cio
echo "ğŸ” Rodando verificaÃ§Ãµes antes do push..."

# Rodar PHPStan (anÃ¡lise estÃ¡tica de cÃ³digo)
echo "ğŸš€ Rodando PHPStan..."
./vendor/bin/phpstan analyse --memory-limit=1G

# Rodar Laravel Pint (padronizaÃ§Ã£o de cÃ³digo)
echo "ğŸ¨ Rodando Laravel Pint..."
./vendor/bin/pint --test

# Rodar Rector (refatoraÃ§Ã£o automÃ¡tica)
echo "ğŸ”§ Rodando Rector..."
./vendor/bin/rector process --dry-run

# Rodar os testes
echo "ğŸ§ª Rodando testes com Pest..."
./vendor/bin/sail test

# Verificar se algum comando falhou
if [ $? -ne 0 ]; then
    echo "âŒ O push foi bloqueado porque um dos comandos falhou."
    exit 1
fi

echo "âœ… Tudo certo! Enviando cÃ³digo..."
exit 0
